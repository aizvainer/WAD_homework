<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./css/style.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap');
    </style>
</head>
<body>
    <main>
        <header>
            <div>
                <div>
                    <a href="./index.html">Home</a>
                    <span>|</span>
                    <a href="./addPost.html">Add Post</a>
                </div>
                <div class="userContainer">
                    <a href="#" class="userLink"></a>
                    <div class="dropdownMenu" id="dropdownMenu">
                        <ul>
                            <li><a href="#">John Doe</a></li>
                            <li><a href="#">john.doe@ut.ee</a></li>
                            <li><a href="#">logout</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            
        </header>

        <div class="mainBlock">
            <div class="sideBlock"></div>

<!--            <div class="articleContainer">

                <article>
                    <div class="articleInfo">
                        <a href="./login.html" class="userLink postLink"></a>
                        <div>Oct 22, 2022</div>
                    </div>
                    <div class="articleBody">
                        <img src="./img/tartu-old-city.jpg" alt="Tartu">
                        Tartu 2022
                    </div>
                    <div>
                        <div class="likeBtn"></div>
                    </div>
                </article>

                <article>
                    <div class="articleInfo">
                        <a href="./login.html" class="userLink postLink"></a>
                        <div>Oct 2, 2022</div>
                    </div>
                    <div class="articleBody">
                        <div>
                            Anyone knows in which room lab is today
                        </div>
                    </div>
                    <div>
                        <div class="likeBtn"></div>
                    </div>
                </article>

                <article>
                    <div class="articleInfo">
                        <a href="./login.html" class="userLink postLink"></a>
                        <div>Oct 2, 2022</div>
                    </div>
                    <div class="articleBody">
                        <div>
                            Does anybody want to study together at Delta?
                        </div>
                    </div>
                    <div>
                        <div class="likeBtn"></div>
                    </div>
                </article>

                <article>
                    <div class="articleInfo">
                        <a href="./login.html" class="userLink postLink"></a>
                        <div>Oct 2, 2022</div>
                    </div>
                    <div class="articleBody">
                        <div>
                            There are many cool events upcoming! Don't miss them!
                        </div>
                    </div>
                    <div>
                        <div class="likeBtn"></div>
                    </div>
                </article>

                <article>
                    <div class="articleInfo">
                        <a href="./login.html" class="userLink postLink"></a>
                        <div>Sept 19, 2022</div>
                    </div>
                    <div class="articleBody">
                        <div>
                            Hey everyone, I just found out about our new homework assignment!  It seems like the academic surprises just keep coming.
                        </div>
                    </div>
                    <div>
                        <div class="likeBtn"></div>
                    </div>
                </article>

                <article>
                    <div class="articleInfo">
                        <a href="./login.html" class="userLink postLink"></a>
                        <div>Sept 4, 2022</div>
                    </div>
                    <div class="articleBody">
                        <div>
                            New school day, new opportunities! Let's go forward to knowledge!
                        </div>
                    </div>
                    <div>
                        <div class="likeBtn"></div>
                    </div>
                </article>
            </div>  -->

            <div id="dynamicPostsContainer"></div>
            <div class="sideBlock"></div>
        </div>
        <footer>Footer</footer>
    </main>
 <script>
        const userLink = document.querySelector('.userLink');
        const dropdownMenu = document.getElementById('dropdownMenu');
        let menuOpen = false;
        
        userLink.addEventListener('click', function (event) {
            event.stopPropagation();
            if (!menuOpen) {
                dropdownMenu.style.display = 'block';
                menuOpen = true;
            } else {
                dropdownMenu.style.display = 'none';
                menuOpen = false;
            }
        });
        
        document.addEventListener('click', function (event) {
            if (menuOpen && event.target == userLink) {
                dropdownMenu.style.display = 'none';
                menuOpen = false;
            }
        });
    </script>

    //from an online source
<!--  <script>
    // JavaScript code to fetch and display posts dynamically
    const dynamicPostsContainer = document.getElementById('dynamicPostsContainer');

    // Create a Set to keep track of post identifiers to avoid duplicates
    const postSet = new Set();

    fetch('https://api.jsonbin.io/v3/b/6545afdf0574da7622c1c4d5')
        .then((response) => response.json())
        .then((data) => {
            const posts = data.record;
            posts.forEach((post, index) => {
                // Create a unique identifier for the post
                const postIdentifier = `${post.author}-${post.text}-${post.timestamp}`;

                // Check if the post identifier is in the Set, if so, skip it
                if (postSet.has(postIdentifier)) {
                    return;
                }

                const article = document.createElement('article');
                const articleInfo = document.createElement('div');
                const userLink = document.createElement('a');
                userLink.href = './login.html'; // Replace with the actual user link
                userLink.classList.add('userLink', 'postLink');
                userLink.textContent = post.author;
                const authorNameContainer = document.createElement('div');
                authorNameContainer.classList.add('authorNameContainer');
                authorNameContainer.appendChild(userLink);
                const dateDiv = document.createElement('div');
                dateDiv.textContent = new Date(post.timestamp * 1000).toLocaleDateString();
                articleInfo.appendChild(userLink);
                articleInfo.appendChild(dateDiv);

                const articleBody = document.createElement('div');
                articleBody.classList.add('articleBody');
                if (post.image) {
                    const image = document.createElement('img');
                    image.src = post.image;
                    image.alt = post.text;
                    articleBody.appendChild(image);
                }

                const text = document.createElement('div');
                text.textContent = post.text;
                articleBody.appendChild(text);

                const likeBtn = document.createElement('div');
                likeBtn.classList.add('likeBtn');

                article.appendChild(articleInfo);
                article.appendChild(articleBody);
                article.appendChild(likeBtn);

                dynamicPostsContainer.appendChild(article);

                // Add the post identifier to the Set to prevent duplicates
                postSet.add(postIdentifier);
            });
        })
        .catch((error) => {
            console.error('Error fetching and displaying posts:', error);
        });
</script> -->
<script>
    // JavaScript code to create and display posts dynamically
    const dynamicPostsContainer = document.getElementById('dynamicPostsContainer');

    // Create a Set to keep track of post identifiers to avoid duplicates
    const postSet = new Set();

    fetch('posts.json') // Fetch the local JSON file
        .then((response) => response.json())
        .then((jsonData) => {
            jsonData.forEach((post, index) => {
                // Create a unique identifier for the post
                const postIdentifier = `${post.author}-${post.text}-${post.timestamp}`;

                // Check if the post identifier is in the Set, if so, skip it
                if (postSet.has(postIdentifier)) {
                    return;
                }

                const article = document.createElement('article');
                const articleInfo = document.createElement('div');
                const userLink = document.createElement('a');
                userLink.href = './login.html'; // Replace with the actual user link
                userLink.classList.add('userLink', 'postLink');
                userLink.textContent = post.author;
                const authorNameContainer = document.createElement('div');
                authorNameContainer.classList.add('authorNameContainer');
                authorNameContainer.appendChild(userLink);
                const dateDiv = document.createElement('div');
                dateDiv.textContent = new Date(post.timestamp * 1000).toLocaleDateString();
                articleInfo.appendChild(userLink);
                articleInfo.appendChild(dateDiv);

                const articleBody = document.createElement('div');
                articleBody.classList.add('articleBody');
                if (post.image) {
                    const image = document.createElement('img');
                    image.src = post.image;
                    image.alt = post.text;
                    articleBody.appendChild(image);
                }

                const text = document.createElement('div');
                text.textContent = post.text;
                articleBody.appendChild(text);

                const likeBtn = document.createElement('div');
                likeBtn.classList.add('likeBtn');

                article.appendChild(articleInfo);
                article.appendChild(articleBody);
                article.appendChild(likeBtn);

                dynamicPostsContainer.appendChild(article);

                // Add the post identifier to the Set to prevent duplicates
                postSet.add(postIdentifier);
            });
        })
        .catch((error) => {
            console.error('Error fetching and displaying posts:', error);
        });
</script>

</body>
</html>